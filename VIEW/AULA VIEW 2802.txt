CREATE VIEW PRODUTO_M (CODIGO, PRODUTO, VALOR, UNIDADE)
AS 
SELECT CODIGO_PRODUTO, DESCRICAO_PRODUTO, VAL_UNIT, UNIDADE
FROM PRODUTO
WHERE UNIDADE = 'M'

SELECT * 
FROM PRODUTO_M

DROP VIEW PRODUTO_M

CREATE VIEW EXEMPLO1
AS
SELECT DISTINCT C.CODIGO_CLIENTE, C.NOME_CLIENTE, C.CIDADE,
	   P.NUM_PEDIDO, V.CODIGO_VENDEDOR, V.NOME_VENDEDOR,
	   V.SALARIO_FIXO, I.QUANTIDADE,
	   PR.CODIGO_PRODUTO, PR.DESCRICAO_PRODUTO,
	   PR.VAL_UNIT,
	   I.QUANTIDADE * PR.VAL_UNIT AS SUBTOTAL
FROM CLIENTE C INNER JOIN PEDIDO P
	ON C.CODIGO_CLIENTE = P.CODIGO_CLIENTE
	INNER JOIN ITEM_DO_PEDIDO I
	ON I.NUM_PEDIDO = P.NUM_PEDIDO
	INNER JOIN PRODUTO PR
	ON I.CODIGO_PRODUTO = PR.CODIGO_PRODUTO
	INNER JOIN VENDEDOR V
	ON P.CODIGO_VENDEDOR = V.CODIGO_VENDEDOR
	
SELECT *
FROM EXEMPLO1

--ATENDIDOS PELA ANA
SELECT DISTINCT NOME_VENDEDOR, CODIGO_VENDEDOR
FROM EXEMPLO1
WHERE UPPER (NOME_CLIENTE) = 'ANA'

--QUANTO CADA VENDEDOR VENDEU
SELECT CODIGO_VENDEDOR, NOME_VENDEDOR, SUM(SUBTOTAL)
FROM EXEMPLO1
GROUP BY CODIGO_VENDEDOR, NOME_VENDEDOR
	
DROP VIEW EXEMPLO1