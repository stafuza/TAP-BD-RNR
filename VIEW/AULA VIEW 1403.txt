CREATE VIEW EX67
AS
SELECT P.NUM_PEDIDO, V.CODIGO_VENDEDOR,
	   V.NOME_VENDEDOR, V.SALARIO_FIXO,
	   E.TOTAL
FROM EX66 E INNER JOIN PEDIDO P 
	 ON E.NUM_PEDIDO=P.NUM_PEDIDO
	 INNER JOIN VENDEDOR V
	 ON P.CODIGO_VENDEDOR=V.CODIGO_VENDEDOR

CREATE VIEW EX66
AS
SELECT NUM_PEDIDO, SUM(SUBTOTAL) AS TOTAL
FROM EX65
GROUP BY NUM_PEDIDO

Create View exercicio65
    (Num_pedido, Codigo, Descricao, quantidade, Val_Unit, Total)as 
         Select i.num_pedido, p.codigo_produto, p.descricao_produto, i.quantidade, p.val_unit, i.quantidade * p.val_unit
     From Item_do_pedido i inner join Produto p 
     On i.codigo_produto=p.codigo_produto

CREATE VIEW EX68
AS 
SELECT V.CODIGO_VENDEDOR, V.NOME_VENDEDOR, SUM(TOTAL) AS TOTAL
FROM EX67 E INNER JOIN PEDIDO P
	ON E.NUM_PEDIDO = P.NUM_PEDIDO
	INNER JOIN VENDEDOR V
	ON P.CODIGO_VENDEDOR = V.CODIGO_VENDEDOR
GROUP BY V.CODIGO_VENDEDOR

CREATE VIEW EX69
AS
SELECT V.CODIGO_VENDEDOR, V.NOME_VENDEDOR, V.SALARIO_FIXO, V.SALARIO_FIXO + SUM(TOTAL_VENDIDO * 0.05) AS SALARIO
FROM EX68 E INNER JOIN VENDEDOR V
	ON E.CODIGO_VENDEDOR = V.CODIGO_VENDEDOR
GROUP BY V.CODIGO_VENDEDOR

SELECT *
FROM EX68

DROP VIEW EX68